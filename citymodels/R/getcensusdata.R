#' Census Data Api
#'
#' This function mines the data needed for the simulations from the US Census
#'
#' It calls other functions in the citymodels package in order to simulate characteristics for households and for each individual
#'
#' @param base_url The base_url for the API
#' @param state The state the user is simulating
#' @param key The key needed to use the API. Can be requested
#' @return census_data A dataframe of the Census data used for simulations in this package




census_data_API<-function(base_url='http://api.census.gov/data/2014/acs5?',state=48,key="6ee9b8141913fdd7763ff46af20c20d0e9a5bc68"){
# Code created using
# http://rstudio-pubs-static.s3.amazonaws.com/19337_2e7f827190514c569ea136db788ce850.html

# getCensusApi
# get Census data via the public API: loop through variables if needed
# Inputs:
#   data_url: the url root of the api, including the '?'
#     example: http://api.census.gov/data/2010/sf1?
#   key: your API key
#   vars: a character vector of variables to get.
#     example c("H0110001","H0110002","H0110003")
#     If there are more than 50, then it will be automatically split into separate queries.
#   region: region to get data for.  contains a for:, and possibly an in:
#     example: for=block:1213&in=state:47+county:015+tract:*
# Output:
#   If successful, a data.frame
#   If unsuccessful, prints the url query that caused the error.
getCensusApi <- function(data_url,key, vars, region, numeric=TRUE){
  if(length(vars)>50){
    vars <- vecToChunk(vars) # Split vars into a list
    get <- lapply(vars, function(x) paste(x, sep='', collapse=","))
    data <- lapply(vars, function(x) getCensusApi2(data_url,key, x, region, numeric=TRUE))
  } else {
    get <- paste(vars, sep='', collapse=',')
    data <- list(getCensusApi2(data_url,key, get, region, numeric=TRUE))
  }
  # Format output.  If there were no errors, than paste the data together
  # If there is an error, just return the unformatted list.
  if(all(sapply(data, is.data.frame))){
    colnames <- unlist(lapply(data, names))
    data <- do.call(cbind,data)
    names(data) <- colnames
    # Prettify the output
    # If there are nonunique colums, remove them
    data <- data[,unique(colnames, fromLast=TRUE)]
    # Reorder columns so that numeric fields follow non-numeric fields
    data <- data[,c(which(sapply(data, class)!='numeric'), which(sapply(data, class)=='numeric'))]
    return(data)
  }else{
    print('unable to create single data.frame in getCensusApi')
    return(data)
  }
}

# getCensusApi2
# get Census data via the public API using a single query
# Inputs:
#   data_url: the url root of the api, including the '?'
#     example: http://api.census.gov/data/2010/sf1?
#   key: your API key
#   get: The variables to get. Separate multiple variables by commas.
#     example 'H0110001,H0110002,H0110003'
#   region: region to get data for.  contains a for:, and possibly an in:
#     example: for=block:1213&in=state:47+county:015+tract:*
# Output:
#   If successful, a data.frame
#   If unsuccessful, prints the url query that was constructed.
getCensusApi2 <- function(data_url,key, get, region, numeric=TRUE){
  if(length(get)>1) get <- paste(get, collapse=',', sep='')
  api_call <- paste(data_url,
                    'key=', key,
                    '&get=', get,
                    '&', region,
                    sep='')

  dat_raw <- try(readLines(api_call, warn="F"))
  if(class(dat_raw)=='try-error') {
    print(api_call)
    return}
  dat_df <- data.frame()

  #split the datastream into a list with each row as an element
  # Thanks to roodmichael on github
  tmp <- strsplit(gsub("[^[:alnum:], _]", '', dat_raw), "\\,")
  #dat_df <- rbind(dat_df, t(sapply(tmp, '[')))
  #names(dat_df) <- sapply(dat_df[1,], as.character)
  #dat_df <- dat_df[-1,]
  dat_df <- as.data.frame(do.call(rbind, tmp[-1]), stringsAsFactors=FALSE)
  names(dat_df) <- tmp[[1]]
  # convert to numeric
  # The fips should stay as character... so how to distinguish fips from data?
  # I think all of the data have numbers in the names, the fips do not
  #  Example: field names of B01001_001E vs state
  if(numeric==TRUE){
    value_cols <- grep("[0-9]", names(dat_df), value=TRUE)
    for(col in value_cols) dat_df[,col] <- as.numeric(as.character(dat_df[,col]))
  }
  return(dat_df)
}

vecToChunk <- function(x, max=50){
  s <- seq_along(x)
  x1 <- split(x, ceiling(s/max))
  return(x1)
}


#api link for housing data
acs5_2014_api <- 'http://api.census.gov/data/2014/acs5?'
#variables used
source('map_variables_from_Census_Table.R')
#Household size and number of vehicles
vars <- c(c(group.quarters.population,
            family.2.person.household,
            family.3.person.household,
            family.4.person.household,
            family.5.person.household,
            family.6.person.household,
            family.7.person.household,
            nonfamily.1.person.household,
            nonfamily.2.person.household,
            nonfamily.3.person.household,
            nonfamily.4.person.household,
            nonfamily.5.person.household,
            nonfamily.6.person.household,
            nonfamily.7.person.household,
            married.couple.families,
            male.householders.no.wife,
            female.householders.no.husband,
            households.of.1.no.vehicle,
            households.of.1.1.vehicle,
            households.of.1.2.vehicles,
            households.of.1.3.vehicles,
            households.of.1.4.vehicles,
            households.of.2.no.vehicle,
            households.of.2.1.vehicle,
            households.of.2.2.vehicles,
            households.of.2.3.vehicles,
            households.of.2.4.vehicles,
            households.of.3.no.vehicle,
            households.of.3.1.vehicle,
            households.of.3.2.vehicles,
            households.of.3.3.vehicles,
            households.of.3.4.vehicles,
            households.of.4.no.vehicle,
            households.of.4.1.vehicle,
            households.of.4.2.vehicles,
            households.of.4.3.vehicles,
            households.of.4.4.vehicles,
            black.boys.under.5,
            black.boys.5.to.9,
            black.boys.10.to.14,
            black.boys.15.to.17,
            black.men.18.to.19,
            black.men.20.to.24,
            black.men.25.to.29,
            black.men.30.to.34,
            black.men.35.to.44,
            black.men.45.to.54,
            black.men.55.to.64,
            black.men.65.to.74,
            black.men.75.to.84,
            black.men.over.85,
            black.girls.under.5,
            black.girls.5.to.9,
            black.girls.10.to.14,
            black.girls.15.to.17,
            black.women.18.to.19,
            black.women.20.to.24,
            black.women.25.to.29,
            black.women.30.to.34,
            black.women.35.to.44,
            black.women.45.to.54,
            black.women.55.to.64,
            black.women.65.to.74,
            black.women.75.to.84,
            black.women.over.85,
            amer.indian.alaskan.boys.under.5,
            amer.indian.alaskan.boys.5.to.9,
            amer.indian.alaskan.boys.10.to.14,
            amer.indian.alaskan.boys.15.to.17,
            amer.indian.alaskan.men.18.to.19,
            amer.indian.alaskan.men.20.to.24,
            amer.indian.alaskan.men.25.to.29,
            amer.indian.alaskan.men.30.to.34,
            amer.indian.alaskan.men.35.to.44,
            amer.indian.alaskan.men.45.to.54,
            amer.indian.alaskan.men.55.to.64,
            amer.indian.alaskan.men.65.to.74,
            amer.indian.alaskan.men.75.to.84,
            amer.indian.alaskan.men.over.85,
            amer.indian.alaskan.girls.under.5,
            amer.indian.alaskan.girls.5.to.9,
            amer.indian.alaskan.girls.10.to.14,
            amer.indian.alaskan.girls.15.to.17,
            amer.indian.alaskan.women.18.to.19,
            amer.indian.alaskan.women.20.to.24,
            amer.indian.alaskan.women.25.to.29,
            amer.indian.alaskan.women.30.to.34,
            amer.indian.alaskan.women.35.to.44,
            amer.indian.alaskan.women.45.to.54,
            amer.indian.alaskan.women.55.to.64,
            amer.indian.alaskan.women.65.to.74,
            amer.indian.alaskan.women.75.to.84,
            amer.indian.alaskan.women.over.85,
            asian.boys.under.5,
            asian.boys.5.to.9,
            asian.boys.10.to.14,
            asian.boys.15.to.17,
            asian.men.18.to.19,
            asian.men.20.to.24,
            asian.men.25.to.29,
            asian.men.30.to.34,
            asian.men.35.to.44,
            asian.men.45.to.54,
            asian.men.55.to.64,
            asian.men.65.to.74,
            asian.men.75.to.84,
            asian.men.over.85,
            asian.girls.under.5,
            asian.girls.5.to.9,
            asian.girls.10.to.14,
            asian.girls.15.to.17,
            asian.women.18.to.19,
            asian.women.20.to.24,
            asian.women.25.to.29,
            asian.women.30.to.34,
            asian.women.35.to.44,
            asian.women.45.to.54,
            asian.women.55.to.64,
            asian.women.65.to.74,
            asian.women.75.to.84,
            asian.women.over.85,
            islander.boys.under.5,
            islander.boys.5.to.9,
            islander.boys.10.to.14,
            islander.boys.15.to.17,
            islander.men.18.to.19,
            islander.men.20.to.24,
            islander.men.25.to.29,
            islander.men.30.to.34,
            islander.men.35.to.44,
            islander.men.45.to.54,
            islander.men.55.to.64,
            islander.men.65.to.74,
            islander.men.75.to.84,
            islander.men.over.85,
            islander.girls.under.5,
            islander.girls.5.to.9,
            islander.girls.10.to.14,
            islander.girls.15.to.17,
            islander.women.18.to.19,
            islander.women.20.to.24,
            islander.women.25.to.29,
            islander.women.30.to.34,
            islander.women.35.to.44,
            islander.women.45.to.54,
            islander.women.55.to.64,
            islander.women.65.to.74,
            islander.women.75.to.84,
            islander.women.over.85,
            other.race.boys.under.5,
            other.race.boys.5.to.9,
            other.race.boys.10.to.14,
            other.race.boys.15.to.17,
            other.race.men.18.to.19,
            other.race.men.20.to.24,
            other.race.men.25.to.29,
            other.race.men.30.to.34,
            other.race.men.35.to.44,
            other.race.men.45.to.54,
            other.race.men.55.to.64,
            other.race.men.65.to.74,
            other.race.men.75.to.84,
            other.race.men.over.85,
            other.race.girls.under.5,
            other.race.girls.5.to.9,
            other.race.girls.10.to.14,
            other.race.girls.15.to.17,
            other.race.women.18.to.19,
            other.race.women.20.to.24,
            other.race.women.25.to.29,
            other.race.women.30.to.34,
            other.race.women.35.to.44,
            other.race.women.45.to.54,
            other.race.women.55.to.64,
            other.race.women.65.to.74,
            other.race.women.75.to.84,
            other.race.women.over.85,
            multiracial.boys.under.5,
            multiracial.boys.5.to.9,
            multiracial.boys.10.to.14,
            multiracial.boys.15.to.17,
            multiracial.men.18.to.19,
            multiracial.men.20.to.24,
            multiracial.men.25.to.29,
            multiracial.men.30.to.34,
            multiracial.men.35.to.44,
            multiracial.men.45.to.54,
            multiracial.men.55.to.64,
            multiracial.men.65.to.74,
            multiracial.men.75.to.84,
            multiracial.men.over.85,
            multiracial.girls.under.5,
            multiracial.girls.5.to.9,
            multiracial.girls.10.to.14,
            multiracial.girls.15.to.17,
            multiracial.women.18.to.19,
            multiracial.women.20.to.24,
            multiracial.women.25.to.29,
            multiracial.women.30.to.34,
            multiracial.women.35.to.44,
            multiracial.women.45.to.54,
            multiracial.women.55.to.64,
            multiracial.women.65.to.74,
            multiracial.women.75.to.84,
            multiracial.women.over.85,
            white.boys.under.5,
            white.boys.5.to.9,
            white.boys.10.to.14,
            white.boys.15.to.17,
            white.men.18.to.19,
            white.men.20.to.24,
            white.men.25.to.29,
            white.men.30.to.34,
            white.men.35.to.44,
            white.men.45.to.54,
            white.men.55.to.64,
            white.men.65.to.74,
            white.men.75.to.84,
            white.men.over.85,
            white.girls.under.5,
            white.girls.5.to.9,
            white.girls.10.to.14,
            white.girls.15.to.17,
            white.women.18.to.19,
            white.women.20.to.24,
            white.women.25.to.29,
            white.women.30.to.34,
            white.women.35.to.44,
            white.women.45.to.54,
            white.women.55.to.64,
            white.women.65.to.74,
            white.women.75.to.84,
            white.women.over.85,
            hispanic.boys.under.5,
            hispanic.boys.5.to.9,
            hispanic.boys.10.to.14,
            hispanic.boys.15.to.17,
            hispanic.men.18.to.19,
            hispanic.men.20.to.24,
            hispanic.men.25.to.29,
            hispanic.men.30.to.34,
            hispanic.men.35.to.44,
            hispanic.men.45.to.54,
            hispanic.men.55.to.64,
            hispanic.men.65.to.74,
            hispanic.men.75.to.84,
            hispanic.men.over.85,
            hispanic.girls.under.5,
            hispanic.girls.5.to.9,
            hispanic.girls.10.to.14,
            hispanic.girls.15.to.17,
            hispanic.women.18.to.19,
            hispanic.women.20.to.24,
            hispanic.women.25.to.29,
            hispanic.women.30.to.34,
            hispanic.women.35.to.44,
            hispanic.women.45.to.54,
            hispanic.women.55.to.64,
            hispanic.women.65.to.74,
            hispanic.women.75.to.84,
            hispanic.women.over.85,
            public.school.women.5.to.9,
            private.school.women.5.to.9,
            no.school.women.5.to.9,
            public.school.women.10.to.14,
            private.school.women.10.to.14,
            no.school.women.10.to.14,
            public.school.women.15.to.17,
            private.school.women.15.to.17,
            no.school.women.15.to.17,
            public.school.women.18.to.19,
            private.school.women.18.to.19,
            no.school.women.18.to.19,
            public.school.women.20.to.24,
            private.school.women.20.to.24,
            no.school.women.20.to.24,
            public.school.women.25.to.34,
            private.school.women.25.to.34,
            no.school.women.25.to.34,
            public.school.women.over.35,
            private.school.women.over.35,
            no.school.women.over.35,
            public.school.men.5.to.9,
            private.school.men.5.to.9,
            no.school.men.5.to.9,
            public.school.men.10.to.14,
            private.school.men.10.to.14,
            no.school.men.10.to.14,
            public.school.men.15.to.17,
            private.school.men.15.to.17,
            no.school.men.15.to.17,
            public.school.men.18.to.19,
            private.school.men.18.to.19,
            no.school.men.18.to.19,
            public.school.men.20.to.24,
            private.school.men.20.to.24,
            no.school.men.20.to.24,
            public.school.men.25.to.34,
            private.school.men.25.to.34,
            no.school.men.25.to.34,
            public.school.men.over.35,
            private.school.men.over.35,
            no.school.men.over.35,
            less.than.9.grade.men.18.24,
            btwn.9.to.12.grade.men.18.24,
            high.school.men.18.24,
            some.college.men.18.24,
            associates.men.18.24,
            bachelors.men.18.24,
            post.grad.men.18.24,
            less.than.9.grade.men.25.34,
            btwn.9.to.12.grade.men.25.34,
            high.school.men.25.34,
            some.college.men.25.34,
            associates.men.25.34,
            bachelors.men.25.34,
            post.grad.men.25.34,
            less.than.9.grade.men.35.44,
            btwn.9.to.12.grade.men.35.44,
            high.school.men.35.44,
            some.college.men.35.44,
            associates.men.35.44,
            bachelors.men.35.44,
            post.grad.men.35.44,
            less.than.9.grade.men.45.64,
            btwn.9.to.12.grade.men.45.64,
            high.school.men.45.64,
            some.college.men.45.64,
            associates.men.45.64,
            bachelors.men.45.64,
            post.grad.men.45.64,
            less.than.9.grade.men.over.65,
            btwn.9.to.12.grade.men.over.65,
            high.school.men.over.65,
            some.college.men.over.65,
            associates.men.over.65,
            bachelors.men.over.65,
            post.grad.men.over.65,
            less.than.9.grade.women.18.24,
            btwn.9.to.12.grade.women.18.24,
            high.school.women.18.24,
            some.college.women.18.24,
            associates.women.18.24,
            bachelors.women.18.24,
            post.grad.women.18.24,
            less.than.9.grade.women.25.34,
            btwn.9.to.12.grade.women.25.34,
            high.school.women.25.34,
            some.college.women.25.34,
            associates.women.25.34,
            bachelors.women.25.34,
            post.grad.women.25.34,
            less.than.9.grade.women.35.44,
            btwn.9.to.12.grade.women.35.44,
            high.school.women.35.44,
            some.college.women.35.44,
            associates.women.35.44,
            bachelors.women.35.44,
            post.grad.women.35.44,
            less.than.9.grade.women.45.64,
            btwn.9.to.12.grade.women.45.64,
            high.school.women.45.64,
            some.college.women.45.64,
            associates.women.45.64,
            bachelors.women.45.64,
            post.grad.women.45.64,
            less.than.9.grade.women.over.65,
            btwn.9.to.12.grade.women.over.65,
            high.school.women.over.65,
            some.college.women.over.65,
            associates.women.over.65,
            bachelors.women.over.65,
            post.grad.women.over.65,
            in.armed.forces.women.16.19,
            employed.women.16.19,
            unemployed.women.16.19,
            not.in.labor.forces.women.16.19,
            in.armed.forces.women.20.21,
            employed.women.20.21,
            unemployed.women.20.21,
            not.in.labor.forces.women.20.21,
            in.armed.forces.women.22.24,
            employed.women.22.24,
            unemployed.women.22.24,
            not.in.labor.forces.women.22.24,
            in.armed.forces.women.25.29,
            employed.women.25.29,
            unemployed.women.25.29,
            not.in.labor.forces.women.25.29,
            in.armed.forces.women.30.34,
            employed.women.30.34,
            unemployed.women.30.34,
            not.in.labor.forces.women.30.34,
            in.armed.forces.women.35.44,
            employed.women.35.44,
            unemployed.women.35.44,
            not.in.labor.forces.women.35.44,
            in.armed.forces.women.45.54,
            employed.women.45.54,
            unemployed.women.45.54,
            not.in.labor.forces.women.45.54,
            in.armed.forces.women.55.59,
            employed.women.55.59,
            unemployed.women.55.59,
            not.in.labor.forces.women.55.59,
            in.armed.forces.women.60.61,
            employed.women.60.61,
            unemployed.women.60.61,
            not.in.labor.forces.women.60.61,
            in.armed.forces.women.62.64,
            employed.women.62.64,
            unemployed.women.62.64,
            not.in.labor.forces.women.62.64,
            employed.women.65.69,
            unemployed.women.65.69,
            not.in.labor.forces.women.65.69,
            employed.women.70.74,
            unemployed.women.70.74,
            not.in.labor.forces.women.70.74,
            employed.women.over.75,
            unemployed.women.over.75,
            not.in.labor.forces.women.over.75,
            in.armed.forces.men.16.19,
            employed.men.16.19,
            unemployed.men.16.19,
            not.in.labor.forces.men.16.19,
            in.armed.forces.men.20.21,
            employed.men.20.21,
            unemployed.men.20.21,
            not.in.labor.forces.men.20.21,
            in.armed.forces.men.22.24,
            employed.men.22.24,
            unemployed.men.22.24,
            not.in.labor.forces.men.22.24,
            in.armed.forces.men.25.29,
            employed.men.25.29,
            unemployed.men.25.29,
            not.in.labor.forces.men.25.29,
            in.armed.forces.men.30.34,
            employed.men.30.34,
            unemployed.men.30.34,
            not.in.labor.forces.men.30.34,
            in.armed.forces.men.35.44,
            employed.men.35.44,
            unemployed.men.35.44,
            not.in.labor.forces.men.35.44,
            in.armed.forces.men.45.54,
            employed.men.45.54,
            unemployed.men.45.54,
            not.in.labor.forces.men.45.54,
            in.armed.forces.men.55.59,
            employed.men.55.59,
            unemployed.men.55.59,
            not.in.labor.forces.men.55.59,
            in.armed.forces.men.60.61,
            employed.men.60.61,
            unemployed.men.60.61,
            not.in.labor.forces.men.60.61,
            in.armed.forces.men.62.64,
            employed.men.62.64,
            unemployed.men.62.64,
            not.in.labor.forces.men.62.64,
            employed.men.65.69,
            unemployed.men.65.69,
            not.in.labor.forces.men.65.69,
            employed.men.70.74,
            unemployed.men.70.74,
            not.in.labor.forces.men.70.74,
            employed.men.over.75,
            unemployed.men.over.75,
            not.in.labor.forces.men.over.75,
            under18.1.disability,
            under18.2.disability,
            under18.no.disability,
            from18.64.1.disability,
            from18.64.2.disability,
            from18.64.no.disability,
            over65.1.disability,
            over65.2.disability,
            over65.no.disability,
            black.native.only.english,
            black.native.other.language.english.well,
            black.native.other.language.english.bad,
            black.foreign.only.english,
            black.foreign.other.language.english.well,
            black.foreign.other.language.english.bad,
            amer.indian.alaskan.native.only.english,
            amer.indian.alaskan.native.other.language.english.well,
            amer.indian.alaskan.native.other.language.english.bad,
            amer.indian.alaskan.foreign.only.english,
            amer.indian.alaskan.foreign.other.language.english.well,
            amer.indian.alaskan.foreign.other.language.english.bad,
            asian.native.only.english,
            asian.native.other.language.english.well,
            asian.native.other.language.english.bad,
            asian.foreign.only.english,
            asian.foreign.other.language.english.well,
            asian.foreign.other.language.english.bad,
            islander.native.only.english,
            islander.native.other.language.english.well,
            islander.native.other.language.english.bad,
            islander.foreign.only.english,
            islander.foreign.other.language.english.well,
            islander.foreign.other.language.english.bad,
            other.native.only.english,
            other.native.other.language.english.well,
            other.native.other.language.english.bad,
            other.foreign.only.english,
            other.foreign.other.language.english.well,
            other.foreign.other.language.english.bad,
            multiracial.native.only.english,
            multiracial.native.other.language.english.well,
            multiracial.native.other.language.english.bad,
            multiracial.foreign.only.english,
            multiracial.foreign.other.language.english.well,
            multiracial.foreign.other.language.english.bad,
            white.native.only.english,
            white.native.other.language.english.well,
            white.native.other.language.english.bad,
            white.foreign.only.english,
            white.foreign.other.language.english.well,
            white.foreign.other.language.english.bad,
            hispanic.native.only.english,
            hispanic.native.other.language.english.well,
            hispanic.native.other.language.english.bad,
            hispanic.foreign.only.english,
            hispanic.foreign.other.language.english.well,
            hispanic.foreign.other.language.english.bad,
            spanish.native.5.17.english.well,
            other.lang.native.5.17.english.well,
            spanish.native.5.17.english.bad,
            other.lang.native.5.17.english.bad,
            spanish.native.over18.english.well,
            other.lang.native.over18.english.well,
            spanish.native.over18.english.bad,
            other.lang.native.over18.english.bad,
            english.foreign.5.17.naturalized,
            english.foreign.5.17.not.citizen,
            spanish.foreign.5.17.naturalized.english.well,
            other.lang.foreign.5.17.naturalized.english.well,
            spanish.foreign.5.17.not.citizen.english.well,
            other.lang.foreign.5.17.not.citizen.english.well,
            spanish.foreign.5.17.naturalized.english.bad,
            other.lang.foreign.5.17.naturalized.english.bad,
            spanish.foreign.5.17.not.citizen.english.bad,
            other.lang.foreign.5.17.not.citizen.english.bad,
            english.foreign.over18.naturalized,
            english.foreign.over18.not.citizen,
            spanish.foreign.18.naturalized.english.well,
            other.lang.foreign.18.naturalized.english.well,
            spanish.foreign.18.not.citizen.english.well,
            other.lang.foreign.18.not.citizen.english.well,
            spanish.foreign.18.naturalized.english.bad,
            other.lang.foreign.18.naturalized.english.bad,
            spanish.foreign.18.not.citizen.english.bad,
            other.lang.foreign.18.not.citizen.english.bad,
            veteran.men.18.34,
            nonveteran.men.18.34,
            veteran.men.35.54,
            nonveteran.men.35.54,
            veteran.men.55.64,
            nonveteran.men.55.64,
            veteran.men.65.74,
            nonveteran.men.65.74,
            veteran.men.over75,
            nonveteran.men.over75,
            veteran.women.18.34,
            nonveteran.women.18.34,
            veteran.women.35.54,
            nonveteran.women.35.54,
            veteran.women.55.64,
            nonveteran.women.55.64,
            veteran.women.65.74,
            nonveteran.women.65.74,
            veteran.women.over75,
            nonveteran.women.over75,
            drove.alone.men,
            carpooled.men,
            public.transport.men,
            bike.men,
            walk.men,
            other.transport.men,
            work.at.home.men,
            drove.alone.women,
            carpooled.women,
            public.transport.women,
            bike.women,
            walk.women,
            other.transport.women,
            work.at.home.women,
            drove.alone.less.than.10.minutes,
            drove.alone.10.14.minutes,
            drove.alone.15.19.minutes,
            drove.alone.20.24.minutes,
            drove.alone.25.29.minutes,
            drove.alone.30.34.minutes,
            drove.alone.35.44.minutes,
            drove.alone.45.59.minutes,
            drove.alone.over60.minutes,
            carpooled.less.than.10.minutes,
            carpooled.10.14.minutes,
            carpooled.15.19.minutes,
            carpooled.20.24.minutes,
            carpooled.25.29.minutes,
            carpooled.30.34.minutes,
            carpooled.35.44.minutes,
            carpooled.45.59.minutes,
            carpooled.over60.minutes,
            public.transport.less.than.10.minutes,
            public.transport.10.14.minutes,
            public.transport.15.19.minutes,
            public.transport.20.24.minutes,
            public.transport.25.29.minutes,
            public.transport.30.34.minutes,
            public.transport.35.44.minutes,
            public.transport.45.59.minutes,
            public.transport.over60.minutes,
            walked.less.than.10.minutes,
            walked.10.14.minutes,
            walked.15.19.minutes,
            walked.20.24.minutes,
            walked.25.29.minutes,
            walked.30.34.minutes,
            walked.35.44.minutes,
            walked.45.59.minutes,
            walked.over60.minutes,
            other.less.than.10.minutes,
            other.10.14.minutes,
            other.15.19.minutes,
            other.20.24.minutes,
            other.25.29.minutes,
            other.30.34.minutes,
            other.35.44.minutes,
            other.45.59.minutes,
            other.over60.minutes,
            income.less.10000,
            income.10000.14999,
            income.15000.19999,
            income.20000.24999,
            income.25000.29999,
            income.30000.34999,
            income.35000.39999,
            income.40000.44999,
            income.45000.49999,
            income.50000.59999,
            income.60000.74999,
            income.75000.99999,
            income.100000.124999,
            income.125000.149999,
            income.150000.199999,
            income.over.200000,
            private.insurance.under25000,
            public.insurance.under25000,
            no.insurance.under25000,
            private.insurance.25.49,
            public.insurance.25.49,
            no.insurance.25.49,
            private.insurance.50.75,
            public.insurance.50.75,
            no.insurance.50.75,
            private.insurance.75.100,
            public.insurance.75.100,
            no.insurance.75.100,
            private.insurance.over100,
            public.insurance.over100,
            no.insurance.over100,
            male0cars,
            male1car,
            male2cars,
            male3cars,
            male4cars,
            male5cars,
            female0cars,
            female1car,
            female2cars,
            female3cars,
            female4cars,
            female5cars,
            individual.no.income,
            individual.less.10000,
            individual.10000.14999,
            individual.15000.19999,
            individual.20000.24999,
            individual.25000.34999,
            individual.35000.49999,
            individual.50000.64999,
            individual.65000.74999,
            individual.over75000,
            with.disability.under18.private.insurance,
            with.disability.under18.public.insurance,
            with.disability.under18.no.insurance,
            without.disability.under18.private.insurance,
            without.disability.under18.public.insurance,
            without.disability.under18.no.insurance,
            with.disability.18.64.private.insurance,
            with.disability.18.64.public.insurance,
            with.disability.18.64.no.insurance,
            without.disability.18.64.private.insurance,
            without.disability.18.64.public.insurance,
            without.disability.18.64.no.insurance,
            with.disability.over65.private.insurance,
            with.disability.over65.public.insurance,
            with.disability.over65.no.insurance,
            without.disability.over65.private.insurance,
            without.disability.over65.public.insurance,
            without.disability.over65.no.insurance))
# Get data for all census tracts in TX
census_data <- getCensusApi(acs5_2014_api, key=key, vars, region=paste0("for=tract:*&in=state:",state))

colnames(census_data)<-c("state","county","tract","group.quarters.population","family.2.person.household",
                         "family.3.person.household",
                         "family.4.person.household",
                         "family.5.person.household",
                         "family.6.person.household",
                         "family.7.person.household",
                         "nonfamily.1.person.household",
                         "nonfamily.2.person.household",
                         "nonfamily.3.person.household",
                         "nonfamily.4.person.household",
                         "nonfamily.5.person.household",
                         "nonfamily.6.person.household",
                         "nonfamily.7.person.household",
                         "married.couple.families",
                         "male.householders.no.wife",
                         "female.householders.no.husband",
                         "households.of.1.no.vehicle",
                         "households.of.1.1.vehicle",
                         "households.of.1.2.vehicles",
                         "households.of.1.3.vehicles",
                         "households.of.1.4.vehicles",
                         "households.of.2.no.vehicle",
                         "households.of.2.1.vehicle",
                         "households.of.2.2.vehicles",
                         "households.of.2.3.vehicles",
                         "households.of.2.4.vehicles",
                         "households.of.3.no.vehicle",
                         "households.of.3.1.vehicle",
                         "households.of.3.2.vehicles",
                         "households.of.3.3.vehicles",
                         "households.of.3.4.vehicles",
                         "households.of.4.no.vehicle",
                         "households.of.4.1.vehicle",
                         "households.of.4.2.vehicles",
                         "households.of.4.3.vehicles",
                         "households.of.4.4.vehicles",
                         "black.boys.under.5",
                         "black.boys.5.to.9",
                         "black.boys.10.to.14",
                         "black.boys.15.to.17",
                         "black.men.18.to.19",
                         "black.men.20.to.24",
                         "black.men.25.to.29",
                         "black.men.30.to.34",
                         "black.men.35.to.44",
                         "black.men.45.to.54",
                         "black.men.55.to.64",
                         "black.men.65.to.74",
                         "black.men.75.to.84",
                         "black.men.over.85",
                         "black.girls.under.5",
                         "black.girls.5.to.9",
                         "black.girls.10.to.14",
                         "black.girls.15.to.17",
                         "black.women.18.to.19",
                         "black.women.20.to.24",
                         "black.women.25.to.29",
                         "black.women.30.to.34",
                         "black.women.35.to.44",
                         "black.women.45.to.54",
                         "black.women.55.to.64",
                         "black.women.65.to.74",
                         "black.women.75.to.84",
                         "black.women.over.85",
                         "amer.indian.alaskan.boys.under.5",
                         "amer.indian.alaskan.boys.5.to.9",
                         "amer.indian.alaskan.boys.10.to.14",
                         "amer.indian.alaskan.boys.15.to.17",
                         "amer.indian.alaskan.men.18.to.19",
                         "amer.indian.alaskan.men.20.to.24",
                         "amer.indian.alaskan.men.25.to.29",
                         "amer.indian.alaskan.men.30.to.34",
                         "amer.indian.alaskan.men.35.to.44",
                         "amer.indian.alaskan.men.45.to.54",
                         "amer.indian.alaskan.men.55.to.64",
                         "amer.indian.alaskan.men.65.to.74",
                         "amer.indian.alaskan.men.75.to.84",
                         "amer.indian.alaskan.men.over.85",
                         "amer.indian.alaskan.girls.under.5",
                         "amer.indian.alaskan.girls.5.to.9",
                         "amer.indian.alaskan.girls.10.to.14",
                         "amer.indian.alaskan.girls.15.to.17",
                         "amer.indian.alaskan.women.18.to.19",
                         "amer.indian.alaskan.women.20.to.24",
                         "amer.indian.alaskan.women.25.to.29",
                         "amer.indian.alaskan.women.30.to.34",
                         "amer.indian.alaskan.women.35.to.44",
                         "amer.indian.alaskan.women.45.to.54",
                         "amer.indian.alaskan.women.55.to.64",
                         "amer.indian.alaskan.women.65.to.74",
                         "amer.indian.alaskan.women.75.to.84",
                         "amer.indian.alaskan.women.over.85",
                         "asian.boys.under.5",
                         "asian.boys.5.to.9",
                         "asian.boys.10.to.14",
                         "asian.boys.15.to.17",
                         "asian.men.18.to.19",
                         "asian.men.20.to.24",
                         "asian.men.25.to.29",
                         "asian.men.30.to.34",
                         "asian.men.35.to.44",
                         "asian.men.45.to.54",
                         "asian.men.55.to.64",
                         "asian.men.65.to.74",
                         "asian.men.75.to.84",
                         "asian.men.over.85",
                         "asian.girls.under.5",
                         "asian.girls.5.to.9",
                         "asian.girls.10.to.14",
                         "asian.girls.15.to.17",
                         "asian.women.18.to.19",
                         "asian.women.20.to.24",
                         "asian.women.25.to.29",
                         "asian.women.30.to.34",
                         "asian.women.35.to.44",
                         "asian.women.45.to.54",
                         "asian.women.55.to.64",
                         "asian.women.65.to.74",
                         "asian.women.75.to.84",
                         "asian.women.over.85",
                         "islander.boys.under.5",
                         "islander.boys.5.to.9",
                         "islander.boys.10.to.14",
                         "islander.boys.15.to.17",
                         "islander.men.18.to.19",
                         "islander.men.20.to.24",
                         "islander.men.25.to.29",
                         "islander.men.30.to.34",
                         "islander.men.35.to.44",
                         "islander.men.45.to.54",
                         "islander.men.55.to.64",
                         "islander.men.65.to.74",
                         "islander.men.75.to.84",
                         "islander.men.over.85",
                         "islander.girls.under.5",
                         "islander.girls.5.to.9",
                         "islander.girls.10.to.14",
                         "islander.girls.15.to.17",
                         "islander.women.18.to.19",
                         "islander.women.20.to.24",
                         "islander.women.25.to.29",
                         "islander.women.30.to.34",
                         "islander.women.35.to.44",
                         "islander.women.45.to.54",
                         "islander.women.55.to.64",
                         "islander.women.65.to.74",
                         "islander.women.75.to.84",
                         "islander.women.over.85",
                         "other.race.boys.under.5",
                         "other.race.boys.5.to.9",
                         "other.race.boys.10.to.14",
                         "other.race.boys.15.to.17",
                         "other.race.men.18.to.19",
                         "other.race.men.20.to.24",
                         "other.race.men.25.to.29",
                         "other.race.men.30.to.34",
                         "other.race.men.35.to.44",
                         "other.race.men.45.to.54",
                         "other.race.men.55.to.64",
                         "other.race.men.65.to.74",
                         "other.race.men.75.to.84",
                         "other.race.men.over.85",
                         "other.race.girls.under.5",
                         "other.race.girls.5.to.9",
                         "other.race.girls.10.to.14",
                         "other.race.girls.15.to.17",
                         "other.race.women.18.to.19",
                         "other.race.women.20.to.24",
                         "other.race.women.25.to.29",
                         "other.race.women.30.to.34",
                         "other.race.women.35.to.44",
                         "other.race.women.45.to.54",
                         "other.race.women.55.to.64",
                         "other.race.women.65.to.74",
                         "other.race.women.75.to.84",
                         "other.race.women.over.85",
                         "multiracial.boys.under.5",
                         "multiracial.boys.5.to.9",
                         "multiracial.boys.10.to.14",
                         "multiracial.boys.15.to.17",
                         "multiracial.men.18.to.19",
                         "multiracial.men.20.to.24",
                         "multiracial.men.25.to.29",
                         "multiracial.men.30.to.34",
                         "multiracial.men.35.to.44",
                         "multiracial.men.45.to.54",
                         "multiracial.men.55.to.64",
                         "multiracial.men.65.to.74",
                         "multiracial.men.75.to.84",
                         "multiracial.men.over.85",
                         "multiracial.girls.under.5",
                         "multiracial.girls.5.to.9",
                         "multiracial.girls.10.to.14",
                         "multiracial.girls.15.to.17",
                         "multiracial.women.18.to.19",
                         "multiracial.women.20.to.24",
                         "multiracial.women.25.to.29",
                         "multiracial.women.30.to.34",
                         "multiracial.women.35.to.44",
                         "multiracial.women.45.to.54",
                         "multiracial.women.55.to.64",
                         "multiracial.women.65.to.74",
                         "multiracial.women.75.to.84",
                         "multiracial.women.over.85",
                         "white.boys.under.5",
                         "white.boys.5.to.9",
                         "white.boys.10.to.14",
                         "white.boys.15.to.17",
                         "white.men.18.to.19",
                         "white.men.20.to.24",
                         "white.men.25.to.29",
                         "white.men.30.to.34",
                         "white.men.35.to.44",
                         "white.men.45.to.54",
                         "white.men.55.to.64",
                         "white.men.65.to.74",
                         "white.men.75.to.84",
                         "white.men.over.85",
                         "white.girls.under.5",
                         "white.girls.5.to.9",
                         "white.girls.10.to.14",
                         "white.girls.15.to.17",
                         "white.women.18.to.19",
                         "white.women.20.to.24",
                         "white.women.25.to.29",
                         "white.women.30.to.34",
                         "white.women.35.to.44",
                         "white.women.45.to.54",
                         "white.women.55.to.64",
                         "white.women.65.to.74",
                         "white.women.75.to.84",
                         "white.women.over.85",
                         "hispanic.boys.under.5",
                         "hispanic.boys.5.to.9",
                         "hispanic.boys.10.to.14",
                         "hispanic.boys.15.to.17",
                         "hispanic.men.18.to.19",
                         "hispanic.men.20.to.24",
                         "hispanic.men.25.to.29",
                         "hispanic.men.30.to.34",
                         "hispanic.men.35.to.44",
                         "hispanic.men.45.to.54",
                         "hispanic.men.55.to.64",
                         "hispanic.men.65.to.74",
                         "hispanic.men.75.to.84",
                         "hispanic.men.over.85",
                         "hispanic.girls.under.5",
                         "hispanic.girls.5.to.9",
                         "hispanic.girls.10.to.14",
                         "hispanic.girls.15.to.17",
                         "hispanic.women.18.to.19",
                         "hispanic.women.20.to.24",
                         "hispanic.women.25.to.29",
                         "hispanic.women.30.to.34",
                         "hispanic.women.35.to.44",
                         "hispanic.women.45.to.54",
                         "hispanic.women.55.to.64",
                         "hispanic.women.65.to.74",
                         "hispanic.women.75.to.84",
                         "hispanic.women.over.85",
                         "public.school.women.5.to.9",
                         "private.school.women.5.to.9",
                         "no.school.women.5.to.9",
                         "public.school.women.10.to.14",
                         "private.school.women.10.to.14",
                         "no.school.women.10.to.14",
                         "public.school.women.15.to.17",
                         "private.school.women.15.to.17",
                         "no.school.women.15.to.17",
                         "public.school.women.18.to.19",
                         "private.school.women.18.to.19",
                         "no.school.women.18.to.19",
                         "public.school.women.20.to.24",
                         "private.school.women.20.to.24",
                         "no.school.women.20.to.24",
                         "public.school.women.25.to.34",
                         "private.school.women.25.to.34",
                         "no.school.women.25.to.34",
                         "public.school.women.over.35",
                         "private.school.women.over.35",
                         "no.school.women.over.35",
                         "public.school.men.5.to.9",
                         "private.school.men.5.to.9",
                         "no.school.men.5.to.9",
                         "public.school.men.10.to.14",
                         "private.school.men.10.to.14",
                         "no.school.men.10.to.14",
                         "public.school.men.15.to.17",
                         "private.school.men.15.to.17",
                         "no.school.men.15.to.17",
                         "public.school.men.18.to.19",
                         "private.school.men.18.to.19",
                         "no.school.men.18.to.19",
                         "public.school.men.20.to.24",
                         "private.school.men.20.to.24",
                         "no.school.men.20.to.24",
                         "public.school.men.25.to.34",
                         "private.school.men.25.to.34",
                         "no.school.men.25.to.34",
                         "public.school.men.over.35",
                         "private.school.men.over.35",
                         "no.school.men.over.35",
                         "less.than.9.grade.men.18.24",
                         "btwn.9.to.12.grade.men.18.24",
                         "high.school.men.18.24",
                         "some.college.men.18.24",
                         "associates.men.18.24",
                         "bachelors.men.18.24",
                         "post.grad.men.18.24",
                         "less.than.9.grade.men.25.34",
                         "btwn.9.to.12.grade.men.25.34",
                         "high.school.men.25.34",
                         "some.college.men.25.34",
                         "associates.men.25.34",
                         "bachelors.men.25.34",
                         "post.grad.men.25.34",
                         "less.than.9.grade.men.35.44",
                         "btwn.9.to.12.grade.men.35.44",
                         "high.school.men.35.44",
                         "some.college.men.35.44",
                         "associates.men.35.44",
                         "bachelors.men.35.44",
                         "post.grad.men.35.44",
                         "less.than.9.grade.men.45.64",
                         "btwn.9.to.12.grade.men.45.64",
                         "high.school.men.45.64",
                         "some.college.men.45.64",
                         "associates.men.45.64",
                         "bachelors.men.45.64",
                         "post.grad.men.45.64",
                         "less.than.9.grade.men.over.65",
                         "btwn.9.to.12.grade.men.over.65",
                         "high.school.men.over.65",
                         "some.college.men.over.65",
                         "associates.men.over.65",
                         "bachelors.men.over.65",
                         "post.grad.men.over.65",
                         "less.than.9.grade.women.18.24",
                         "btwn.9.to.12.grade.women.18.24",
                         "high.school.women.18.24",
                         "some.college.women.18.24",
                         "associates.women.18.24",
                         "bachelors.women.18.24",
                         "post.grad.women.18.24",
                         "less.than.9.grade.women.25.34",
                         "btwn.9.to.12.grade.women.25.34",
                         "high.school.women.25.34",
                         "some.college.women.25.34",
                         "associates.women.25.34",
                         "bachelors.women.25.34",
                         "post.grad.women.25.34",
                         "less.than.9.grade.women.35.44",
                         "btwn.9.to.12.grade.women.35.44",
                         "high.school.women.35.44",
                         "some.college.women.35.44",
                         "associates.women.35.44",
                         "bachelors.women.35.44",
                         "post.grad.women.35.44",
                         "less.than.9.grade.women.45.64",
                         "btwn.9.to.12.grade.women.45.64",
                         "high.school.women.45.64",
                         "some.college.women.45.64",
                         "associates.women.45.64",
                         "bachelors.women.45.64",
                         "post.grad.women.45.64",
                         "less.than.9.grade.women.over.65",
                         "btwn.9.to.12.grade.women.over.65",
                         "high.school.women.over.65",
                         "some.college.women.over.65",
                         "associates.women.over.65",
                         "bachelors.women.over.65",
                         "post.grad.women.over.65",
                         "in.armed.forces.women.16.19",
                         "employed.women.16.19",
                         "unemployed.women.16.19",
                         "not.in.labor.forces.women.16.19",
                         "in.armed.forces.women.20.21",
                         "employed.women.20.21",
                         "unemployed.women.20.21",
                         "not.in.labor.forces.women.20.21",
                         "in.armed.forces.women.22.24",
                         "employed.women.22.24",
                         "unemployed.women.22.24",
                         "not.in.labor.forces.women.22.24",
                         "in.armed.forces.women.25.29",
                         "employed.women.25.29",
                         "unemployed.women.25.29",
                         "not.in.labor.forces.women.25.29",
                         "in.armed.forces.women.30.34",
                         "employed.women.30.34",
                         "unemployed.women.30.34",
                         "not.in.labor.forces.women.30.34",
                         "in.armed.forces.women.35.44",
                         "employed.women.35.44",
                         "unemployed.women.35.44",
                         "not.in.labor.forces.women.35.44",
                         "in.armed.forces.women.45.54",
                         "employed.women.45.54",
                         "unemployed.women.45.54",
                         "not.in.labor.forces.women.45.54",
                         "in.armed.forces.women.55.59",
                         "employed.women.55.59",
                         "unemployed.women.55.59",
                         "not.in.labor.forces.women.55.59",
                         "in.armed.forces.women.60.61",
                         "employed.women.60.61",
                         "unemployed.women.60.61",
                         "not.in.labor.forces.women.60.61",
                         "in.armed.forces.women.62.64",
                         "employed.women.62.64",
                         "unemployed.women.62.64",
                         "not.in.labor.forces.women.62.64",
                         "employed.women.65.69",
                         "unemployed.women.65.69",
                         "not.in.labor.forces.women.65.69",
                         "employed.women.70.74",
                         "unemployed.women.70.74",
                         "not.in.labor.forces.women.70.74",
                         "employed.women.over.75",
                         "unemployed.women.over.75",
                         "not.in.labor.forces.women.over.75",
                         "in.armed.forces.men.16.19",
                         "employed.men.16.19",
                         "unemployed.men.16.19",
                         "not.in.labor.forces.men.16.19",
                         "in.armed.forces.men.20.21",
                         "employed.men.20.21",
                         "unemployed.men.20.21",
                         "not.in.labor.forces.men.20.21",
                         "in.armed.forces.men.22.24",
                         "employed.men.22.24",
                         "unemployed.men.22.24",
                         "not.in.labor.forces.men.22.24",
                         "in.armed.forces.men.25.29",
                         "employed.men.25.29",
                         "unemployed.men.25.29",
                         "not.in.labor.forces.men.25.29",
                         "in.armed.forces.men.30.34",
                         "employed.men.30.34",
                         "unemployed.men.30.34",
                         "not.in.labor.forces.men.30.34",
                         "in.armed.forces.men.35.44",
                         "employed.men.35.44",
                         "unemployed.men.35.44",
                         "not.in.labor.forces.men.35.44",
                         "in.armed.forces.men.45.54",
                         "employed.men.45.54",
                         "unemployed.men.45.54",
                         "not.in.labor.forces.men.45.54",
                         "in.armed.forces.men.55.59",
                         "employed.men.55.59",
                         "unemployed.men.55.59",
                         "not.in.labor.forces.men.55.59",
                         "in.armed.forces.men.60.61",
                         "employed.men.60.61",
                         "unemployed.men.60.61",
                         "not.in.labor.forces.men.60.61",
                         "in.armed.forces.men.62.64",
                         "employed.men.62.64",
                         "unemployed.men.62.64",
                         "not.in.labor.forces.men.62.64",
                         "employed.men.65.69",
                         "unemployed.men.65.69",
                         "not.in.labor.forces.men.65.69",
                         "employed.men.70.74",
                         "unemployed.men.70.74",
                         "not.in.labor.forces.men.70.74",
                         "employed.men.over.75",
                         "unemployed.men.over.75",
                         "not.in.labor.forces.men.over.75",
                         "under18.1.disability",
                         "under18.2.disability",
                         "under18.no.disability",
                         "from18.64.1.disability",
                         "from18.64.2.disability",
                         "from18.64.no.disability",
                         "over65.1.disability",
                         "over65.2.disability",
                         "over65.no.disability",
                         "black.native.only.english",
                         "black.native.other.language.english.well",
                         "black.native.other.language.english.bad",
                         "black.foreign.only.english",
                         "black.foreign.other.language.english.well",
                         "black.foreign.other.language.english.bad",
                         "amer.indian.alaskan.native.only.english",
                         "amer.indian.alaskan.native.other.language.english.well",
                         "amer.indian.alaskan.native.other.language.english.bad",
                         "amer.indian.alaskan.foreign.only.english",
                         "amer.indian.alaskan.foreign.other.language.english.well",
                         "amer.indian.alaskan.foreign.other.language.english.bad",
                         "asian.native.only.english",
                         "asian.native.other.language.english.well",
                         "asian.native.other.language.english.bad",
                         "asian.foreign.only.english",
                         "asian.foreign.other.language.english.well",
                         "asian.foreign.other.language.english.bad",
                         "islander.native.only.english",
                         "islander.native.other.language.english.well",
                         "islander.native.other.language.english.bad",
                         "islander.foreign.only.english",
                         "islander.foreign.other.language.english.well",
                         "islander.foreign.other.language.english.bad",
                         "other.native.only.english",
                         "other.native.other.language.english.well",
                         "other.native.other.language.english.bad",
                         "other.foreign.only.english",
                         "other.foreign.other.language.english.well",
                         "other.foreign.other.language.english.bad",
                         "multiracial.native.only.english",
                         "multiracial.native.other.language.english.well",
                         "multiracial.native.other.language.english.bad",
                         "multiracial.foreign.only.english",
                         "multiracial.foreign.other.language.english.well",
                         "multiracial.foreign.other.language.english.bad",
                         "white.native.only.english",
                         "white.native.other.language.english.well",
                         "white.native.other.language.english.bad",
                         "white.foreign.only.english",
                         "white.foreign.other.language.english.well",
                         "white.foreign.other.language.english.bad",
                         "hispanic.native.only.english",
                         "hispanic.native.other.language.english.well",
                         "hispanic.native.other.language.english.bad",
                         "hispanic.foreign.only.english",
                         "hispanic.foreign.other.language.english.well",
                         "hispanic.foreign.other.language.english.bad",
                         "spanish.native.5.17.english.well",
                         "other.lang.native.5.17.english.well",
                         "spanish.native.5.17.english.bad",
                         "other.lang.native.5.17.english.bad",
                         "spanish.native.over18.english.well",
                         "other.lang.native.over18.english.well",
                         "spanish.native.over18.english.bad",
                         "other.lang.native.over18.english.bad",
                         "english.foreign.5.17.naturalized",
                         "english.foreign.5.17.not.citizen",
                         "spanish.foreign.5.17.naturalized.english.well",
                         "other.lang.foreign.5.17.naturalized.english.well",
                         "spanish.foreign.5.17.not.citizen.english.well",
                         "other.lang.foreign.5.17.not.citizen.english.well",
                         "spanish.foreign.5.17.naturalized.english.bad",
                         "other.lang.foreign.5.17.naturalized.english.bad",
                         "spanish.foreign.5.17.not.citizen.english.bad",
                         "other.lang.foreign.5.17.not.citizen.english.bad",
                         "english.foreign.over18.naturalized",
                         "english.foreign.over18.not.citizen",
                         "spanish.foreign.18.naturalized.english.well",
                         "other.lang.foreign.18.naturalized.english.well",
                         "spanish.foreign.18.not.citizen.english.well",
                         "other.lang.foreign.18.not.citizen.english.well",
                         "spanish.foreign.18.naturalized.english.bad",
                         "other.lang.foreign.18.naturalized.english.bad",
                         "spanish.foreign.18.not.citizen.english.bad",
                         "other.lang.foreign.18.not.citizen.english.bad",
                         "veteran.men.18.34",
                         "nonveteran.men.18.34",
                         "veteran.men.35.54",
                         "nonveteran.men.35.54",
                         "veteran.men.55.64",
                         "nonveteran.men.55.64",
                         "veteran.men.65.74",
                         "nonveteran.men.65.74",
                         "veteran.men.over75",
                         "nonveteran.men.over75",
                         "veteran.women.18.34",
                         "nonveteran.women.18.34",
                         "veteran.women.35.54",
                         "nonveteran.women.35.54",
                         "veteran.women.55.64",
                         "nonveteran.women.55.64",
                         "veteran.women.65.74",
                         "nonveteran.women.65.74",
                         "veteran.women.over75",
                         "nonveteran.women.over75",
                         "drove.alone.men",
                         "carpooled.men",
                         "public.transport.men",
                         "bike.men",
                         "walk.men",
                         "other.transport.men",
                         "work.at.home.men",
                         "drove.alone.women",
                         "carpooled.women",
                         "public.transport.women",
                         "bike.women",
                         "walk.women",
                         "other.transport.women",
                         "work.at.home.women",
                         "drove.alone.less.than.10.minutes",
                         "drove.alone.10.14.minutes",
                         "drove.alone.15.19.minutes",
                         "drove.alone.20.24.minutes",
                         "drove.alone.25.29.minutes",
                         "drove.alone.30.34.minutes",
                         "drove.alone.35.44.minutes",
                         "drove.alone.45.59.minutes",
                         "drove.alone.over60.minutes",
                         "carpooled.less.than.10.minutes",
                         "carpooled.10.14.minutes",
                         "carpooled.15.19.minutes",
                         "carpooled.20.24.minutes",
                         "carpooled.25.29.minutes",
                         "carpooled.30.34.minutes",
                         "carpooled.35.44.minutes",
                         "carpooled.45.59.minutes",
                         "carpooled.over60.minutes",
                         "public.transport.less.than.10.minutes",
                         "public.transport.10.14.minutes",
                         "public.transport.15.19.minutes",
                         "public.transport.20.24.minutes",
                         "public.transport.25.29.minutes",
                         "public.transport.30.34.minutes",
                         "public.transport.35.44.minutes",
                         "public.transport.45.59.minutes",
                         "public.transport.over60.minutes",
                         "walked.less.than.10.minutes",
                         "walked.10.14.minutes",
                         "walked.15.19.minutes",
                         "walked.20.24.minutes",
                         "walked.25.29.minutes",
                         "walked.30.34.minutes",
                         "walked.35.44.minutes",
                         "walked.45.59.minutes",
                         "walked.over60.minutes",
                         "other.less.than.10.minutes",
                         "other.10.14.minutes",
                         "other.15.19.minutes",
                         "other.20.24.minutes",
                         "other.25.29.minutes",
                         "other.30.34.minutes",
                         "other.35.44.minutes",
                         "other.45.59.minutes",
                         "other.over60.minutes",
                         "income.less.10000",
                         "income.10000.14999",
                         "income.15000.19999",
                         "income.20000.24999",
                         "income.25000.29999",
                         "income.30000.34999",
                         "income.35000.39999",
                         "income.40000.44999",
                         "income.45000.49999",
                         "income.50000.59999",
                         "income.60000.74999",
                         "income.75000.99999",
                         "income.100000.124999",
                         "income.125000.149999",
                         "income.150000.199999",
                         "income.over.200000",
                         "private.insurance.under25000",
                         "public.insurance.under25000",
                         "no.insurance.under25000",
                         "private.insurance.25.49",
                         "public.insurance.25.49",
                         "no.insurance.25.49",
                         "private.insurance.50.75",
                         "public.insurance.50.75",
                         "no.insurance.50.75",
                         "private.insurance.75.100",
                         "public.insurance.75.100",
                         "no.insurance.75.100",
                         "private.insurance.over100",
                         "public.insurance.over100",
                         "no.insurance.over100",
                         "male0cars",
                         "male1car",
                         "male2cars",
                         "male3cars",
                         "male4cars",
                         "male5cars",
                         "female0cars",
                         "female1car",
                         "female2cars",
                         "female3cars",
                         "female4cars",
                         "female5cars",
                         "individual.no.income",
                         "individual.less.10000",
                         "individual.10000.14999",
                         "individual.15000.19999",
                         "individual.20000.24999",
                         "individual.25000.34999",
                         "individual.35000.49999",
                         "individual.50000.64999",
                         "individual.65000.74999",
                         "individual.over75000",
                         "with.disability.under18.private.insurance",
                         "with.disability.under18.public.insurance",
                         "with.disability.under18.no.insurance",
                         "without.disability.under18.private.insurance",
                         "without.disability.under18.public.insurance",
                         "without.disability.under18.no.insurance",
                         "with.disability.18.64.private.insurance",
                         "with.disability.18.64.public.insurance",
                         "with.disability.18.64.no.insurance",
                         "without.disability.18.64.private.insurance",
                         "without.disability.18.64.public.insurance",
                         "without.disability.18.64.no.insurance",
                         "with.disability.over65.private.insurance",
                         "with.disability.over65.public.insurance",
                         "with.disability.over65.no.insurance",
                         "without.disability.over65.private.insurance",
                         "without.disability.over65.public.insurance",
                         "without.disability.over65.no.insurance")

#write data frame to csv file without quotes
#saveRDS(census_data,"Census_data.RDS")
#write.csv(census_data, file = "Census_data.csv",row.names=FALSE, na="", quote = FALSE)
return(census_data)
}
